-- Warpah Carry - Stealth Carry System
-- Compact Professional Design (Fixed Version)

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

if game.CoreGui:FindFirstChild("WarpahCarryGUI") then
    game.CoreGui.WarpahCarryGUI:Destroy()
end

local Config = {
    CarryEnabled = false,
    TargetPlayer = nil,
    FollowDistance = 0, -- Sejajar/menempel dengan target
    InvisibleMode = false, -- Invisible mode dinonaktifkan
    IsMinimized = false
}

-- Fungsi invisible dihilangkan/dinonaktifkan
local function MakeInvisible()
    -- Fungsi ini dinonaktifkan
    return
end

local function MakeVisible()
    -- Tidak perlu lagi karena tidak ada invisible mode
    return
end

local function GetAllPlayersWithDistance()
    local playerList = {}
    
    pcall(function()
        if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            return
        end
        
        local localPos = LocalPlayer.Character.HumanoidRootPart.Position
        
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                pcall(function()
                    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                        local distance = (player.Character.HumanoidRootPart.Position - localPos).Magnitude
                        table.insert(playerList, {
                            Player = player,
                            Distance = math.floor(distance)
                        })
                    end
                end)
            end
        end
        
        table.sort(playerList, function(a, b)
            return a.Distance < b.Distance
        end)
    end)
    
    return playerList
end

local function FollowPlayer()
    if not Config.CarryEnabled or not Config.TargetPlayer then return end
    
    pcall(function()
        local targetChar = Config.TargetPlayer.Character
        local localChar = LocalPlayer.Character
        
        if targetChar and localChar and targetChar:FindFirstChild("HumanoidRootPart") and localChar:FindFirstChild("HumanoidRootPart") then
            local targetRoot = targetChar.HumanoidRootPart
            local localRoot = localChar.HumanoidRootPart
            local targetHumanoid = targetChar:FindFirstChild("Humanoid")
            
            -- Ambil arah belakang dari target dengan offset yang lebih tepat
            local backDirection = -targetRoot.CFrame.LookVector
            
            -- Posisi tepat di belakang target, sejajar dan menempel
            local offset = Config.FollowDistance
            local backPosition = targetRoot.Position + (backDirection * offset)
            
            -- Sejajarkan tinggi dengan target
            local newPosition = Vector3.new(
                backPosition.X, 
                targetRoot.Position.Y, -- Gunakan Y position yang sama dengan target
                backPosition.Z
            )
            
            -- Buat CFrame yang menghadap ke arah yang sama dengan target
            local newCFrame = CFrame.new(newPosition) * targetRoot.CFrame.Rotation
            
            -- Set posisi dan rotasi karakter kita
            localRoot.CFrame = newCFrame
            
            -- Set velocity agar mengikuti gerakan target
            if localRoot:FindFirstChild("BodyVelocity") then
                localRoot.BodyVelocity:Destroy()
            end
            
            local bodyVelocity = Instance.new("BodyVelocity")
            bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
            
            -- Jika target bergerak, ikuti kecepatannya
            if targetHumanoid and targetHumanoid.WalkSpeed > 0 then
                local targetVelocity = targetRoot.AssemblyLinearVelocity
                bodyVelocity.Velocity = targetVelocity
            else
                bodyVelocity.Velocity = Vector3.new(0, 0, 0)
            end
            
            bodyVelocity.Parent = localRoot
            
            -- Delay untuk hapus BodyVelocity agar tidak mengganggu movement
            wait(0.05)
            if bodyVelocity and bodyVelocity.Parent then
                bodyVelocity:Destroy()
            end
        end
    end)
end

local function CreateGUI()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WarpahCarryGUI"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    local success = pcall(function()
        ScreenGui.Parent = game:GetService("CoreGui")
    end)
    
    if not success then
        ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    end
    
    -- Main Container
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 280, 0, 380)
    MainFrame.Position = UDim2.new(1, -290, 0.5, -190)
    MainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 22)
    MainFrame.BorderSizePixel = 0
    MainFrame.Active = true
    MainFrame.Draggable = true
    MainFrame.ClipsDescendants = true
    MainFrame.Parent = ScreenGui
    
    local MainCorner = Instance.new("UICorner")
    MainCorner.CornerRadius = UDim.new(0, 8)
    MainCorner.Parent = MainFrame
    
    local MainStroke = Instance.new("UIStroke")
    MainStroke.Color = Color3.fromRGB(40, 40, 45)
    MainStroke.Thickness = 1
    MainStroke.Parent = MainFrame
    
    -- Header
    local Header = Instance.new("Frame")
    Header.Size = UDim2.new(1, 0, 0, 45)
    Header.BackgroundColor3 = Color3.fromRGB(22, 22, 28)
    Header.BorderSizePixel = 0
    Header.Parent = MainFrame
    
    local HeaderCorner = Instance.new("UICorner")
    HeaderCorner.CornerRadius = UDim.new(0, 8)
    HeaderCorner.Parent = Header
    
    local HeaderBottom = Instance.new("Frame")
    HeaderBottom.Size = UDim2.new(1, 0, 0, 8)
    HeaderBottom.Position = UDim2.new(0, 0, 1, -8)
    HeaderBottom.BackgroundColor3 = Color3.fromRGB(22, 22, 28)
    HeaderBottom.BorderSizePixel = 0
    HeaderBottom.Parent = Header
    
    local AccentLine = Instance.new("Frame")
    AccentLine.Size = UDim2.new(1, 0, 0, 2)
    AccentLine.Position = UDim2.new(0, 0, 1, 0)
    AccentLine.BackgroundColor3 = Color3.fromRGB(0, 230, 118)
    AccentLine.BorderSizePixel = 0
    AccentLine.Parent = Header
    
    -- Title
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, -80, 1, 0)
    Title.Position = UDim2.new(0, 12, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "Warpah Carry (Fixed)"
    Title.TextColor3 = Color3.fromRGB(240, 240, 245)
    Title.TextSize = 14
    Title.Font = Enum.Font.GothamBold
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = Header
    
    -- Buttons Container
    local ButtonsContainer = Instance.new("Frame")
    ButtonsContainer.Size = UDim2.new(0, 70, 1, 0)
    ButtonsContainer.Position = UDim2.new(1, -70, 0, 0)
    ButtonsContainer.BackgroundTransparency = 1
    ButtonsContainer.Parent = Header
    
    local MinimizeBtn = Instance.new("TextButton")
    MinimizeBtn.Size = UDim2.new(0, 30, 0, 30)
    MinimizeBtn.Position = UDim2.new(0, 5, 0.5, -15)
    MinimizeBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 52)
    MinimizeBtn.BorderSizePixel = 0
    MinimizeBtn.Text = "−"
    MinimizeBtn.TextColor3 = Color3.fromRGB(200, 200, 210)
    MinimizeBtn.TextSize = 16
    MinimizeBtn.Font = Enum.Font.GothamBold
    MinimizeBtn.Parent = ButtonsContainer
    
    local MinCorner = Instance.new("UICorner")
    MinCorner.CornerRadius = UDim.new(0, 6)
    MinCorner.Parent = MinimizeBtn
    
    local CloseBtn = Instance.new("TextButton")
    CloseBtn.Size = UDim2.new(0, 30, 0, 30)
    CloseBtn.Position = UDim2.new(0, 37, 0.5, -15)
    CloseBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 52)
    CloseBtn.BorderSizePixel = 0
    CloseBtn.Text = "×"
    CloseBtn.TextColor3 = Color3.fromRGB(200, 200, 210)
    CloseBtn.TextSize = 20
    CloseBtn.Font = Enum.Font.GothamBold
    CloseBtn.Parent = ButtonsContainer
    
    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 6)
    CloseCorner.Parent = CloseBtn
    
    -- Content
    local Content = Instance.new("Frame")
    Content.Name = "Content"
    Content.Size = UDim2.new(1, -20, 1, -65)
    Content.Position = UDim2.new(0, 10, 0, 55)
    Content.BackgroundTransparency = 1
    Content.Parent = MainFrame
    
    -- Status Container
    local StatusFrame = Instance.new("Frame")
    StatusFrame.Size = UDim2.new(1, 0, 0, 30)
    StatusFrame.BackgroundColor3 = Color3.fromRGB(28, 28, 36)
    StatusFrame.BorderSizePixel = 0
    StatusFrame.Parent = Content
    
    local StatusCorner = Instance.new("UICorner")
    StatusCorner.CornerRadius = UDim.new(0, 6)
    StatusCorner.Parent = StatusFrame
    
    local StatusDot = Instance.new("Frame")
    StatusDot.Size = UDim2.new(0, 8, 0, 8)
    StatusDot.Position = UDim2.new(0, 12, 0.5, -4)
    StatusDot.BackgroundColor3 = Color3.fromRGB(239, 68, 68)
    StatusDot.BorderSizePixel = 0
    StatusDot.Parent = StatusFrame
    
    local DotCorner = Instance.new("UICorner")
    DotCorner.CornerRadius = UDim.new(1, 0)
    DotCorner.Parent = StatusDot
    
    local StatusText = Instance.new("TextLabel")
    StatusText.Size = UDim2.new(1, -30, 1, 0)
    StatusText.Position = UDim2.new(0, 26, 0, 0)
    StatusText.BackgroundTransparency = 1
    StatusText.Text = "Idle"
    StatusText.TextColor3 = Color3.fromRGB(180, 180, 195)
    StatusText.TextSize = 11
    StatusText.Font = Enum.Font.GothamMedium
    StatusText.TextXAlignment = Enum.TextXAlignment.Left
    StatusText.Parent = StatusFrame
    
    -- Search Box
    local SearchFrame = Instance.new("Frame")
    SearchFrame.Size = UDim2.new(1, 0, 0, 32)
    SearchFrame.Position = UDim2.new(0, 0, 0, 40)
    SearchFrame.BackgroundColor3 = Color3.fromRGB(28, 28, 36)
    SearchFrame.BorderSizePixel = 0
    SearchFrame.Parent = Content
    
    local SearchCorner = Instance.new("UICorner")
    SearchCorner.CornerRadius = UDim.new(0, 6)
    SearchCorner.Parent = SearchFrame
    
    local SearchIcon = Instance.new("TextLabel")
    SearchIcon.Size = UDim2.new(0, 30, 1, 0)
    SearchIcon.BackgroundTransparency = 1
    SearchIcon.Text = "🔍"
    SearchIcon.TextColor3 = Color3.fromRGB(130, 130, 145)
    SearchIcon.TextSize = 14
    SearchIcon.Font = Enum.Font.Gotham
    SearchIcon.Parent = SearchFrame
    
    local SearchBox = Instance.new("TextBox")
    SearchBox.Size = UDim2.new(1, -35, 1, 0)
    SearchBox.Position = UDim2.new(0, 30, 0, 0)
    SearchBox.BackgroundTransparency = 1
    SearchBox.PlaceholderText = "Search players..."
    SearchBox.PlaceholderColor3 = Color3.fromRGB(100, 100, 110)
    SearchBox.Text = ""
    SearchBox.TextColor3 = Color3.fromRGB(200, 200, 210)
    SearchBox.TextSize = 11
    SearchBox.Font = Enum.Font.Gotham
    SearchBox.TextXAlignment = Enum.TextXAlignment.Left
    SearchBox.ClearTextOnFocus = false
    SearchBox.Parent = SearchFrame
    
    -- Players List
    local ListFrame = Instance.new("Frame")
    ListFrame.Size = UDim2.new(1, 0, 1, -155)
    ListFrame.Position = UDim2.new(0, 0, 0, 82)
    ListFrame.BackgroundColor3 = Color3.fromRGB(22, 22, 28)
    ListFrame.BorderSizePixel = 0
    ListFrame.Parent = Content
    
    local ListCorner = Instance.new("UICorner")
    ListCorner.CornerRadius = UDim.new(0, 6)
    ListCorner.Parent = ListFrame
    
    local ScrollFrame = Instance.new("ScrollingFrame")
    ScrollFrame.Size = UDim2.new(1, -4, 1, -4)
    ScrollFrame.Position = UDim2.new(0, 2, 0, 2)
    ScrollFrame.BackgroundTransparency = 1
    ScrollFrame.BorderSizePixel = 0
    ScrollFrame.ScrollBarThickness = 4
    ScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(45, 45, 52)
    ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    ScrollFrame.Parent = ListFrame
    
    local ListLayout = Instance.new("UIListLayout")
    ListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    ListLayout.Padding = UDim.new(0, 4)
    ListLayout.Parent = ScrollFrame
    
    -- Control Buttons
    local ButtonsFrame = Instance.new("Frame")
    ButtonsFrame.Size = UDim2.new(1, 0, 0, 65)
    ButtonsFrame.Position = UDim2.new(0, 0, 1, -65)
    ButtonsFrame.BackgroundTransparency = 1
    ButtonsFrame.Parent = Content
    
    local StopBtn = Instance.new("TextButton")
    StopBtn.Size = UDim2.new(0.48, 0, 0, 28)
    StopBtn.Position = UDim2.new(0, 0, 0, 0)
    StopBtn.BackgroundColor3 = Color3.fromRGB(239, 68, 68)
    StopBtn.BorderSizePixel = 0
    StopBtn.Text = "Stop Follow"
    StopBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    StopBtn.TextSize = 11
    StopBtn.Font = Enum.Font.GothamMedium
    StopBtn.Parent = ButtonsFrame
    
    local StopCorner = Instance.new("UICorner")
    StopCorner.CornerRadius = UDim.new(0, 6)
    StopCorner.Parent = StopBtn
    
    local RefreshBtn = Instance.new("TextButton")
    RefreshBtn.Size = UDim2.new(0.48, 0, 0, 28)
    RefreshBtn.Position = UDim2.new(0.52, 0, 0, 0)
    RefreshBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 100)
    RefreshBtn.BorderSizePixel = 0
    RefreshBtn.Text = "Refresh List"
    RefreshBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    RefreshBtn.TextSize = 11
    RefreshBtn.Font = Enum.Font.GothamMedium
    RefreshBtn.Parent = ButtonsFrame
    
    local RefreshCorner = Instance.new("UICorner")
    RefreshCorner.CornerRadius = UDim.new(0, 6)
    RefreshCorner.Parent = RefreshBtn
    
    -- Distance Slider (untuk adjust jarak follow)
    local SliderFrame = Instance.new("Frame")
    SliderFrame.Size = UDim2.new(1, 0, 0, 28)
    SliderFrame.Position = UDim2.new(0, 0, 0, 33)
    SliderFrame.BackgroundColor3 = Color3.fromRGB(28, 28, 36)
    SliderFrame.BorderSizePixel = 0
    SliderFrame.Parent = ButtonsFrame
    
    local SliderCorner = Instance.new("UICorner")
    SliderCorner.CornerRadius = UDim.new(0, 6)
    SliderCorner.Parent = SliderFrame
    
    local SliderLabel = Instance.new("TextLabel")
    SliderLabel.Size = UDim2.new(0, 60, 1, 0)
    SliderLabel.Position = UDim2.new(0, 8, 0, 0)
    SliderLabel.BackgroundTransparency = 1
    SliderLabel.Text = "Distance:"
    SliderLabel.TextColor3 = Color3.fromRGB(130, 130, 145)
    SliderLabel.TextSize = 10
    SliderLabel.Font = Enum.Font.GothamMedium
    SliderLabel.TextXAlignment = Enum.TextXAlignment.Left
    SliderLabel.Parent = SliderFrame
    
    local SliderValue = Instance.new("TextLabel")
    SliderValue.Size = UDim2.new(0, 40, 1, 0)
    SliderValue.Position = UDim2.new(1, -45, 0, 0)
    SliderValue.BackgroundTransparency = 1
    SliderValue.Text = "0"
    SliderValue.TextColor3 = Color3.fromRGB(0, 230, 118)
    SliderValue.TextSize = 10
    SliderValue.Font = Enum.Font.GothamBold
    SliderValue.Parent = SliderFrame
    
    local SliderBar = Instance.new("Frame")
    SliderBar.Size = UDim2.new(0, 120, 0, 4)
    SliderBar.Position = UDim2.new(0, 68, 0.5, -2)
    SliderBar.BackgroundColor3 = Color3.fromRGB(45, 45, 52)
    SliderBar.BorderSizePixel = 0
    SliderBar.Parent = SliderFrame
    
    local SliderBarCorner = Instance.new("UICorner")
    SliderBarCorner.CornerRadius = UDim.new(1, 0)
    SliderBarCorner.Parent = SliderBar
    
    local SliderKnob = Instance.new("Frame")
    SliderKnob.Size = UDim2.new(0, 12, 0, 12)
    SliderKnob.Position = UDim2.new(0, -6, 0.5, -6)
    SliderKnob.BackgroundColor3 = Color3.fromRGB(0, 230, 118)
    SliderKnob.BorderSizePixel = 0
    SliderKnob.Parent = SliderBar
    
    local SliderKnobCorner = Instance.new("UICorner")
    SliderKnobCorner.CornerRadius = UDim.new(1, 0)
    SliderKnobCorner.Parent = SliderKnob
    
    -- Slider functionality
    local draggingSlider = false
    local SliderButton = Instance.new("TextButton")
    SliderButton.Size = UDim2.new(1, 20, 1, 20)
    SliderButton.Position = UDim2.new(0, -10, 0, -10)
    SliderButton.BackgroundTransparency = 1
    SliderButton.Text = ""
    SliderButton.Parent = SliderKnob
    
    SliderButton.MouseButton1Down:Connect(function()
        draggingSlider = true
    end)
    
    game:GetService("UserInputService").InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            draggingSlider = false
        end
    end)
    
    SliderButton.MouseMoved:Connect(function(x, y)
        if draggingSlider then
            local relativeX = x - SliderBar.AbsolutePosition.X
            local percentage = math.clamp(relativeX / SliderBar.AbsoluteSize.X, 0, 1)
            
            SliderKnob.Position = UDim2.new(percentage, -6, 0.5, -6)
            
            local distance = math.floor(percentage * 5 * 10) / 10 -- 0 to 5 studs
            Config.FollowDistance = distance
            SliderValue.Text = tostring(distance)
        end
    end)
    
    -- Update Player List Function
    local function UpdatePlayerList(searchQuery)
        pcall(function()
            searchQuery = searchQuery or ""
            searchQuery = searchQuery:lower()
            
            for _, child in pairs(ScrollFrame:GetChildren()) do
                if child:IsA("Frame") then
                    child:Destroy()
                end
            end
            
            local playerData = GetAllPlayersWithDistance()
            
            for index, data in ipairs(playerData) do
                local player = data.Player
                local dist = data.Distance
                
                if searchQuery == "" or player.Name:lower():find(searchQuery) or player.DisplayName:lower():find(searchQuery) then
                    local Card = Instance.new("Frame")
                    Card.Size = UDim2.new(1, -6, 0, 44)
                    Card.BackgroundColor3 = Color3.fromRGB(28, 28, 36)
                    Card.BorderSizePixel = 0
                    Card.Parent = ScrollFrame
                    
                    local CardCorner = Instance.new("UICorner")
                    CardCorner.CornerRadius = UDim.new(0, 6)
                    CardCorner.Parent = Card
                    
                    local Btn = Instance.new("TextButton")
                    Btn.Size = UDim2.new(1, 0, 1, 0)
                    Btn.BackgroundTransparency = 1
                    Btn.Text = ""
                    Btn.Parent = Card
                    
                    local Avatar = Instance.new("Frame")
                    Avatar.Size = UDim2.new(0, 30, 0, 30)
                    Avatar.Position = UDim2.new(0, 7, 0.5, -15)
                    Avatar.BackgroundColor3 = Color3.fromRGB(0, 230, 118)
                    Avatar.BorderSizePixel = 0
                    Avatar.Parent = Card
                    
                    local AvatarCorner = Instance.new("UICorner")
                    AvatarCorner.CornerRadius = UDim.new(0, 6)
                    AvatarCorner.Parent = Avatar
                    
                    local AvatarText = Instance.new("TextLabel")
                    AvatarText.Size = UDim2.new(1, 0, 1, 0)
                    AvatarText.BackgroundTransparency = 1
                    AvatarText.Text = player.Name:sub(1, 2):upper()
                    AvatarText.TextColor3 = Color3.fromRGB(255, 255, 255)
                    AvatarText.TextSize = 13
                    AvatarText.Font = Enum.Font.GothamBold
                    AvatarText.Parent = Avatar
                    
                    local NameLabel = Instance.new("TextLabel")
                    NameLabel.Size = UDim2.new(1, -100, 0, 16)
                    NameLabel.Position = UDim2.new(0, 42, 0, 8)
                    NameLabel.BackgroundTransparency = 1
                    NameLabel.Text = player.Name
                    NameLabel.TextColor3 = Color3.fromRGB(220, 220, 230)
                    NameLabel.TextSize = 11
                    NameLabel.Font = Enum.Font.GothamMedium
                    NameLabel.TextXAlignment = Enum.TextXAlignment.Left
                    NameLabel.TextTruncate = Enum.TextTruncate.AtEnd
                    NameLabel.Parent = Card
                    
                    local DistLabel = Instance.new("TextLabel")
                    DistLabel.Size = UDim2.new(1, -100, 0, 14)
                    DistLabel.Position = UDim2.new(0, 42, 0, 22)
                    DistLabel.BackgroundTransparency = 1
                    DistLabel.Text = dist .. " studs"
                    DistLabel.TextColor3 = Color3.fromRGB(130, 130, 145)
                    DistLabel.TextSize = 9
                    DistLabel.Font = Enum.Font.Gotham
                    DistLabel.TextXAlignment = Enum.TextXAlignment.Left
                    DistLabel.Parent = Card
                    
                    local Indicator = Instance.new("Frame")
                    Indicator.Name = "Indicator"
                    Indicator.Size = UDim2.new(0, 3, 1, -8)
                    Indicator.Position = UDim2.new(1, -6, 0, 4)
                    Indicator.BackgroundColor3 = Color3.fromRGB(0, 230, 118)
                    Indicator.BorderSizePixel = 0
                    Indicator.Visible = false
                    Indicator.Parent = Card
                    
                    local IndCorner = Instance.new("UICorner")
                    IndCorner.CornerRadius = UDim.new(1, 0)
                    IndCorner.Parent = Indicator
                    
                    Btn.MouseEnter:Connect(function()
                        if Config.TargetPlayer ~= player then
                            Card.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
                        end
                    end)
                    
                    Btn.MouseLeave:Connect(function()
                        if Config.TargetPlayer ~= player then
                            Card.BackgroundColor3 = Color3.fromRGB(28, 28, 36)
                        end
                    end)
                    
                    Btn.MouseButton1Click:Connect(function()
                        Config.TargetPlayer = player
                        Config.CarryEnabled = true
                        
                        StatusText.Text = "Following " .. player.Name
                        StatusDot.BackgroundColor3 = Color3.fromRGB(0, 230, 118)
                        
                        for _, c in pairs(ScrollFrame:GetChildren()) do
                            if c:IsA("Frame") and c:FindFirstChild("Indicator") then
                                c.BackgroundColor3 = Color3.fromRGB(28, 28, 36)
                                c.Indicator.Visible = false
                            end
                        end
                        
                        Card.BackgroundColor3 = Color3.fromRGB(15, 65, 40)
                        Indicator.Visible = true
                    end)
                end
            end
            
            ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, ListLayout.AbsoluteContentSize.Y + 12)
        end)
    end
    
    SearchBox:GetPropertyChangedSignal("Text"):Connect(function()
        UpdatePlayerList(SearchBox.Text)
    end)
    
    -- Button Actions
    MinimizeBtn.MouseButton1Click:Connect(function()
        Config.IsMinimized = not Config.IsMinimized
        
        if Config.IsMinimized then
            MinimizeBtn.Text = "□"
            Content.Visible = false
            TweenService:Create(MainFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quart), {
                Size = UDim2.new(0, 280, 0, 45)
            }):Play()
        else
            MinimizeBtn.Text = "−"
            Content.Visible = true
            TweenService:Create(MainFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quart), {
                Size = UDim2.new(0, 280, 0, 380)
            }):Play()
        end
    end)
    
    CloseBtn.MouseButton1Click:Connect(function()
        Config.CarryEnabled = false
        ScreenGui:Destroy()
    end)
    
    StopBtn.MouseButton1Click:Connect(function()
        Config.CarryEnabled = false
        Config.TargetPlayer = nil
        StatusText.Text = "Idle"
        StatusDot.BackgroundColor3 = Color3.fromRGB(239, 68, 68)
        
        for _, c in pairs(ScrollFrame:GetChildren()) do
            if c:IsA("Frame") and c:FindFirstChild("Indicator") then
                c.BackgroundColor3 = Color3.fromRGB(28, 28, 36)
                c.Indicator.Visible = false
            end
        end
    end)
    
    RefreshBtn.MouseButton1Click:Connect(function()
        UpdatePlayerList(SearchBox.Text)
    end)
    
    -- Hover Effects
    MinimizeBtn.MouseEnter:Connect(function()
        MinimizeBtn.BackgroundColor3 = Color3.fromRGB(55, 55, 62)
    end)
    MinimizeBtn.MouseLeave:Connect(function()
        MinimizeBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 52)
    end)
    
    CloseBtn.MouseEnter:Connect(function()
        CloseBtn.BackgroundColor3 = Color3.fromRGB(239, 68, 68)
        CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    end)
    CloseBtn.MouseLeave:Connect(function()
        CloseBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 52)
        CloseBtn.TextColor3 = Color3.fromRGB(200, 200, 210)
    end)
    
    StopBtn.MouseEnter:Connect(function()
        StopBtn.BackgroundColor3 = Color3.fromRGB(255, 88, 88)
    end)
    StopBtn.MouseLeave:Connect(function()
        StopBtn.BackgroundColor3 = Color3.fromRGB(239, 68, 68)
    end)
    
    RefreshBtn.MouseEnter:Connect(function()
        RefreshBtn.BackgroundColor3 = Color3.fromRGB(0, 230, 118)
    end)
    RefreshBtn.MouseLeave:Connect(function()
        RefreshBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 100)
    end)
    
    UpdatePlayerList()
    
    spawn(function()
        while ScreenGui and ScreenGui.Parent do
            wait(5)
            if ScreenGui and ScreenGui.Parent and not Config.CarryEnabled then
                pcall(function()
                    UpdatePlayerList(SearchBox.Text)
                end)
            end
        end
    end)
    
    MainFrame.Position = UDim2.new(1, 50, 0.5, -190)
    TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {
        Position = UDim2.new(1, -290, 0.5, -190)
    }):Play()
end

local connection
connection = RunService.Heartbeat:Connect(function()
    if Config.CarryEnabled and Config.TargetPlayer then
        FollowPlayer()
    end
end)

LocalPlayer.CharacterAdded:Connect(function(char)
    wait(0.5)
    -- Tidak ada invisible mode lagi
end)

Players.PlayerRemoving:Connect(function(player)
    if Config.TargetPlayer == player then
        Config.CarryEnabled = false
        Config.TargetPlayer = nil
    end
end)

wait(0.5)
CreateGUI()

print("━━━━━━━━━━━━━━━━━━━━━━━━")
print("✓ Warpah Carry Fixed - Loaded")
print("✓ Invisible mode removed")
print("✓ Better positioning system")
print("━━━━━━━━━━━━━━━━━━━━━━━━")
